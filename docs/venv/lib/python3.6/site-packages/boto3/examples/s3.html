

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>List objects in an Amazon S3 bucket &mdash; T-Vecs 1 documentation</title>
  

  
  <link rel="stylesheet" href="../../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../../" src="../../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../../_static/jquery.js"></script>
        <script src="../../../../../../_static/underscore.js"></script>
        <script src="../../../../../../_static/doctools.js"></script>
        <script src="../../../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../../index.html" class="icon icon-home" alt="Documentation Home"> T-Vecs
          

          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Usage Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../README.html">T-Vecs</a></li>
</ul>
<p class="caption"><span class="caption-text">Development Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../_dev_docs/modules.html">tvecs</a></li>
</ul>
<p class="caption"><span class="caption-text">Testing Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../_test_docs/modules.html">tests</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../index.html">T-Vecs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>List objects in an Amazon S3 bucket</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../../../_sources/venv/lib/python3.6/site-packages/boto3/examples/s3.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="list-objects-in-an-amazon-s3-bucket">
<h1>List objects in an Amazon S3 bucket<a class="headerlink" href="#list-objects-in-an-amazon-s3-bucket" title="Permalink to this headline">¶</a></h1>
<p>The following example shows how to use an Amazon S3 bucket resource to list
the objects in the bucket.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">boto3</span>

<span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="n">bucket</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">Bucket</span><span class="p">(</span><span class="s1">&#39;my-bucket&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">bucket</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="list-top-level-common-prefixes-in-amazon-s3-bucket">
<h1>List top-level common prefixes in Amazon S3 bucket<a class="headerlink" href="#list-top-level-common-prefixes-in-amazon-s3-bucket" title="Permalink to this headline">¶</a></h1>
<p>This example shows how to list all of the top-level common prefixes in an
Amazon S3 bucket:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">boto3</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="n">paginator</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_paginator</span><span class="p">(</span><span class="s1">&#39;list_objects&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">paginate</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="s1">&#39;my-bucket&#39;</span><span class="p">,</span> <span class="n">Delimiter</span><span class="o">=</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;CommonPrefixes&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">prefix</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Prefix&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="restore-glacier-objects-in-an-amazon-s3-bucket">
<h1>Restore Glacier objects in an Amazon S3 bucket<a class="headerlink" href="#restore-glacier-objects-in-an-amazon-s3-bucket" title="Permalink to this headline">¶</a></h1>
<p>The following example shows how to initiate restoration of glacier objects in
an Amazon S3 bucket, determine if a restoration is on-going, and determine if a
restoration is finished.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">boto3</span>

<span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="n">bucket</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">Bucket</span><span class="p">(</span><span class="s1">&#39;glacier-bucket&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">obj_sum</span> <span class="ow">in</span> <span class="n">bucket</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">Object</span><span class="p">(</span><span class="n">obj_sum</span><span class="o">.</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">obj_sum</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">storage_class</span> <span class="o">==</span> <span class="s1">&#39;GLACIER&#39;</span><span class="p">:</span>
        <span class="c1"># Try to restore the object if the storage class is glacier and</span>
        <span class="c1"># the object does not have a completed or ongoing restoration</span>
        <span class="c1"># request.</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">restore</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Submitting restoration request: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">restore_object</span><span class="p">(</span><span class="n">RestoreRequest</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Days&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
        <span class="c1"># Print out objects whose restoration is on-going</span>
        <span class="k">elif</span> <span class="s1">&#39;ongoing-request=&quot;true&quot;&#39;</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">restore</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Restoration in-progress: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
        <span class="c1"># Print out objects whose restoration is complete</span>
        <span class="k">elif</span> <span class="s1">&#39;ongoing-request=&quot;false&quot;&#39;</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">restore</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Restoration complete: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="uploading-downloading-files-using-sse-kms">
<h1>Uploading/downloading files using SSE KMS<a class="headerlink" href="#uploading-downloading-files-using-sse-kms" title="Permalink to this headline">¶</a></h1>
<p>This example shows how to use SSE-KMS to upload objects using
server side encryption with a key managed by KMS.</p>
<p>We can either use the default KMS master key, or create a
custom key in AWS and use it to encrypt the object by passing in its
key id.</p>
<p>With KMS, nothing else needs to be provided for getting the
object; S3 already knows how to decrypt the object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">boto3</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">BUCKET</span> <span class="o">=</span> <span class="s1">&#39;your-bucket-name&#39;</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="n">keyid</span> <span class="o">=</span> <span class="s1">&#39;&lt;the key id&gt;&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Uploading S3 object with SSE-KMS&quot;</span><span class="p">)</span>
<span class="n">s3</span><span class="o">.</span><span class="n">put_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">BUCKET</span><span class="p">,</span>
              <span class="n">Key</span><span class="o">=</span><span class="s1">&#39;encrypt-key&#39;</span><span class="p">,</span>
              <span class="n">Body</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;foobar&#39;</span><span class="p">,</span>
              <span class="n">ServerSideEncryption</span><span class="o">=</span><span class="s1">&#39;aws:kms&#39;</span><span class="p">,</span>
              <span class="c1"># Optional: SSEKMSKeyId</span>
              <span class="n">SSEKMSKeyId</span><span class="o">=</span><span class="n">keyid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done&quot;</span><span class="p">)</span>

<span class="c1"># Getting the object:</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Getting S3 object...&quot;</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">BUCKET</span><span class="p">,</span>
                         <span class="n">Key</span><span class="o">=</span><span class="s1">&#39;encrypt-key&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done, response body:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;Body&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="uploading-downloading-files-using-sse-customer-keys">
<h1>Uploading/downloading files using SSE Customer Keys<a class="headerlink" href="#uploading-downloading-files-using-sse-customer-keys" title="Permalink to this headline">¶</a></h1>
<p>This example shows how to use SSE-C to upload objects using
server side encryption with a customer provided key.</p>
<p>First, we’ll need a 32 byte key.  For this example, we’ll
randomly generate a key but you can use any 32 byte key
you want.  Remember, you must the same key to download
the object.  If you lose the encryption key, you lose
the object.</p>
<p>Also note how we don’t have to provide the SSECustomerKeyMD5.
Boto3 will automatically compute this value for us.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">boto3</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">BUCKET</span> <span class="o">=</span> <span class="s1">&#39;your-bucket-name&#39;</span>
<span class="n">KEY</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Uploading S3 object with SSE-C&quot;</span><span class="p">)</span>
<span class="n">s3</span><span class="o">.</span><span class="n">put_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">BUCKET</span><span class="p">,</span>
              <span class="n">Key</span><span class="o">=</span><span class="s1">&#39;encrypt-key&#39;</span><span class="p">,</span>
              <span class="n">Body</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;foobar&#39;</span><span class="p">,</span>
              <span class="n">SSECustomerKey</span><span class="o">=</span><span class="n">KEY</span><span class="p">,</span>
              <span class="n">SSECustomerAlgorithm</span><span class="o">=</span><span class="s1">&#39;AES256&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done&quot;</span><span class="p">)</span>

<span class="c1"># Getting the object:</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Getting S3 object...&quot;</span><span class="p">)</span>
<span class="c1"># Note how we&#39;re using the same ``KEY`` we</span>
<span class="c1"># created earlier.</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">BUCKET</span><span class="p">,</span>
                         <span class="n">Key</span><span class="o">=</span><span class="s1">&#39;encrypt-key&#39;</span><span class="p">,</span>
                         <span class="n">SSECustomerKey</span><span class="o">=</span><span class="n">KEY</span><span class="p">,</span>
                         <span class="n">SSECustomerAlgorithm</span><span class="o">=</span><span class="s1">&#39;AES256&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done, response body:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;Body&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2016, Kshitij Karthick, Ravi Kumar L, Prateeksha, Prarthana Sannamani

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>